<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API</title>
</head>
<body>
<script type="module">
    import {matchString} from "./js/api.js";

    /**
     * @typedef MatchResultLike
     * @property {WordQueue} wordQueue
     * @property {Boolean} typed
     * @property {String[]} types
     * @property {String} inputString
     * @property {String} string - the additional property instead of the overrided `toString` method.
     */

    window.onmessage = async function(event) {
        const {data: {words, id}, source, origin} = event;
        console.log("API input:", {data: {words, id}, source, origin}, event);
        /** @type {MatchResult} */
        const result = await matchString(words);

        // The overrided toString() will be unavailable.
        /** @type {MatchResultLike} */
        const _result = {
            ...result,
            string: result.wordQueue.toString()
        };

        console.log("API result:", _result);
        source.postMessage({
            result: _result,
            from: "gfy-id-camel-caser",
            messageId: id
        }, origin);
    };
</script>
</body>
</html>